\ProvidesPackage{beamerthemeegi}

\mode<presentation>

\newdimen\head@height
\head@height=35pt

\definecolor{links}{HTML}{2A1B81}
\hypersetup{colorlinks,linkcolor=,urlcolor=links}

\definecolor{egiblue}{RGB}{0,103,167}
\setbeamercolor{section in head}{fg=egiblue}
\setbeamercolor{egi in head}{fg=egiblue}
\setbeamercolor{date in foot}{fg=white,bg=egiblue}

\setbeamertemplate{navigation symbols}{}

\newbox\logobox
\setbox\logobox\hbox{\includegraphics[height=\head@height]{images/egi-engage.png}}

\defbeamertemplate*{headline}{egi theme}{\hrule height0pt depth0pt}

\newdimen\headI

\defbeamertemplate*{frametitle}{egi theme} {
    \nointerlineskip
    \baselineskip=0pt
    \lineskip=0pt
    \parsep=0pt
    \headI=\head@height
    \advance\headI-15pt
    \begin{beamercolorbox}[wd=\paperwidth,ht=\headI,dp=10pt]{section in head}
        \hfill\textbf{\insertframetitle\ }
    \end{beamercolorbox}
    \vspace{4pt}
    \begin{beamercolorbox}[wd=\paperwidth,ht=6pt,dp=3pt]{egi in head}
        \vbox to 6pt{
            \hsize=\wd\logobox
            \vss\leavevmode\lower1pt\copy\logobox\par
        }
        \hfill\tiny\hskip1em \insertframesubtitle \quad \strut
    \end{beamercolorbox}
}

\defbeamertemplate*{footline}{egi theme} {
    \ifnum \thepage=1\relax

        \begin{beamercolorbox}{egi in head}
            \quad \includegraphics[height=\head@height]{images/egi.png}
            \vspace{1em}

            \quad\hrulefill\quad
            \vspace{1em}
        \end{beamercolorbox}
        \hfill
        \begin{beamercolorbox}[wd=0.9\paperwidth,dp=0pt]{egi in head}
            \quad www.egi.eu
            \hfill
            \raggedleft
            \tiny EGI-Engage is co-funded by the Horizon 2020 Framework Programme \\
            of the European Union under grant  number 654142
            \vspace{0.1cm}
        \end{beamercolorbox}  
        \includegraphics[height=0.6cm]{images/eu.png}
        \quad\strut
    \else
            \leavevmode
            \begin{beamercolorbox}[wd=\paperwidth,ht=3ex,dp=1ex]{date in foot}
                {\flushleft \quad \today \hfill \insertframenumber \quad \strut }
            \end{beamercolorbox}
    \fi
}


\setbeamercolor{alerted text}{fg=egiblue!90!black}
\setbeamerfont{alerted text}{series=\bfseries}

\setbeamertemplate{itemize item}{{\color{egiblue}$\bullet$}}
\setbeamertemplate{itemize subitem}{{\color{egiblue}\textbf{--}}}
\setbeamertemplate{itemize subsubitem}{{\color{egiblue}$\scriptstyle\blacktriangleright$}}

\setbeamertemplate{background}{
    \ifnum \thepage=1\relax
        \includegraphics[height=\paperheight]{images/back.png}
    \else
        \includegraphics[height=0.5\paperheight]{images/back_white.png}
    \fi
}

\newdimen\headP
\setbeamertemplate{title page}{
    \nointerlineskip
    \lineskip=0pt
    \vfill
    \textbf{\Large\inserttitle}
    \bigskip

    \usebeamerfont{author}\insertauthor\par
    \usebeamerfont{institute}\insertinstitute\par
}
